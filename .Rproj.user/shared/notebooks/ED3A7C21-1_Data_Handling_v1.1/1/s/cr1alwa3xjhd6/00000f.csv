"0","# ========================================================================"
"0","# 3. データ読み込みと前処理"
"0","# ========================================================================"
"0",""
"0","#' データファイルの読み込みと基本的な前処理"
"0","#' @param file_path Excelファイルのパス"
"0","#' @return 前処理済みデータフレーム"
"0","load_and_preprocess <- function(file_path) {"
"0","  # Excelファイル読み込み"
"0","  ds_raw <- suppressWarnings("
"0","    readxl::read_excel(file_path, sheet = 1, guess_max = 100000)"
"0","  )"
"0","  "
"0","  # 型推論の再実行"
"0","  ds <- readr::type_convert(ds_raw, locale = readr::locale(encoding = ""UTF-8""))"
"0","  "
"0","  # 列名の正規化（全角・連続スペースを半角1つに）"
"0","  names(ds) <- names(ds) |>"
"0","    stringr::str_replace_all(""[\u3000\\s]+"", "" "") |>"
"0","    trimws()"
"0","  "
"0","  # 基本的な列名統一"
"0","  if (""Group"" %in% names(ds)) {"
"0","    ds <- dplyr::rename(ds, group = Group)"
"0","  }"
"0","  "
"0","  return(ds)"
"0","}"
