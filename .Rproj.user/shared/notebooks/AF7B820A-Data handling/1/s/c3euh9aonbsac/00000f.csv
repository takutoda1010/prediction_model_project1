"0","# 手術時間 → 分（op_time_min）に統一"
"0","# ※ ds01 に既に op_time_min があるなら、この mutate だけ上書きでOK。他の列は一切変更しません。"
"0","library(stringr)"
"0","ds01 <- ds01 |>"
"0","  dplyr::mutate(op_time_min = {"
"0","    x <- str_squish(as.character(`手術時間`))"
"0","    x <- str_replace_all(x, ""："", "":"")         # 全角コロン対策"
"0",""
"0","    has_colon <- str_detect(x, "":"")"
"0","    # ""H:MM"" or ""HH:MM[:SS]"" → 分"
"0","    parts <- str_split_fixed(x, "":"", 3)"
"0","    hh <- suppressWarnings(as.numeric(parts[,1]))"
"0","    mm <- suppressWarnings(as.numeric(parts[,2]))"
"0","    ss <- suppressWarnings(as.numeric(parts[,3]))"
"0","    from_colon <- ifelse(has_colon, hh*60 + mm + ifelse(is.na(ss), 0, round(ss/60)), NA_real_)"
"0",""
"0","    # 小数(= 1日の小数) → 分（1日=1440分）"
"0","    num <- suppressWarnings(as.numeric(x))"
"0","    from_frac <- ifelse(!has_colon & !is.na(num), num * 1440, NA_real_)"
"0",""
"0","    # どちらか取れた方を採用（丸めは最終段階で）"
"0","    round(dplyr::coalesce(from_colon, from_frac))"
"0","  })"
"0",""
"0",""
