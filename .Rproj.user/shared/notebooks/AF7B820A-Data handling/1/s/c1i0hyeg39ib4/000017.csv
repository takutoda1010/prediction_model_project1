"0","# num（連番）"
"0","# 基本属性（ID 追加）"
"0","ds01 <- ds01 |>"
"0","  mutate(id = as.character(ID...3)) |>   # ★追加：ID を英語名 id で保持"
"0","  mutate(num = suppressWarnings(as.numeric(Num)))"
"2","mutate: no changes"
"2","mutate: no changes"
"0","# group（Con/NAC vs others）ref = ""others"""
"0","# ds00$Group を ""Con_or_NAC"" / ""other"" に統一（表記ゆれ吸収）"
"0","ds00 <- ds00 |>"
"0","  dplyr::mutate(Group = {"
"0","    g <- as.character(Group)"
"0","    g <- stringr::str_replace_all(g, ""\u3000"", "" "")   # 全角スペース→半角"
"0","    g <- stringr::str_squish(g)                       # 余分な空白除去"
"0","    gl <- tolower(g)"
"0","    gl <- stringr::str_replace_all(gl, ""_"", "" "")      # アンダースコアも空白扱いに"
"0",""
"0","    is_con_nac <- stringr::str_detect(gl, ""\\bcon\\b"") & stringr::str_detect(gl, ""\\bnac\\b"")"
"0","    dplyr::if_else(is_con_nac, ""Con_or_NAC"", ""other"")"
"0","  })"
"0",""
"0","# 参照カテゴリを ""other"" に固定"
"0","ds01 <- ds00 <- dplyr::rename(ds00, group = Group)"
"0",""
"0",""
"0",""
"0","# 手術時/診断時 R/BR1/BR2（ref = ""R""）"
"0","if (""手術時群分け R/BR1/BR2"" %in% names(ds01))"
"0","  ds01 <- ds01 |> mutate(stage_surg = factor(`手術時群分け R/BR1/BR2`, levels = c(""R"",""BR1"",""BR2"")))"
"0","if (""診断時群分け R/BR1/BR2"" %in% names(ds01))"
"0","  ds01 <- ds01 |> mutate(stage_diag = factor(`診断時群分け R/BR1/BR2`, levels = c(""R"",""BR1"",""BR2"")))"
"0",""
"0","# 群分け R/BR（BR1/BR2 を BR に寄せ、ref = ""R""）"
"0","if (""群分け R/BR"" %in% names(ds01))"
"0","  ds01 <- ds01 |>"
"0","    mutate(group_rb = {"
"0","      x <- str_squish(as.character(`群分け R/BR`))"
"0","      x <- ifelse(x %in% c(""BR1"",""BR2""), ""BR"", x)"
"0","      factor(x, levels = c(""R"",""BR""))  # reference = ""R"""
"0","    })"
"0",""
