"0","# ① ds07の連続変数のうち強い歪み（|skew| > 1）のある変数をリストアップ"
"0","skewness_ <- function(x){"
"0","  x <- x[is.finite(x)]"
"0","  if (length(x) < 3) return(NA_real_)"
"0","  m <- mean(x); s <- stats::sd(x)"
"0","  if (!is.finite(s) || s == 0) return(NA_real_)"
"0","  mean((x - m)^3) / (s^3)"
"0","}"
"0",""
"0","num_cols <- names(ds07)[vapply(ds07, is.numeric, logical(1))]"
"0","cont_cols <- num_cols[!grepl(""^(id|num)$"", num_cols, ignore.case = TRUE) &"
"0","                        vapply(ds07[num_cols], function(v) length(unique(na.omit(v))) >= 5, logical(1))]"
"0",""
"0","skew_tbl <- tibble::tibble(var = cont_cols) |>"
"0","  dplyr::rowwise() |>"
"0","  dplyr::mutate("
"0","    skew = skewness_(ds07[[var]]),"
"0","    min  = suppressWarnings(min(ds07[[var]], na.rm = TRUE)),"
"0","    p25  = suppressWarnings(stats::quantile(ds07[[var]], 0.25, na.rm = TRUE, type = 2)),"
"0","    med  = suppressWarnings(stats::median(ds07[[var]], na.rm = TRUE)),"
"0","    p75  = suppressWarnings(stats::quantile(ds07[[var]], 0.75, na.rm = TRUE, type = 2)),"
"0","    max  = suppressWarnings(max(ds07[[var]], na.rm = TRUE)),"
"0","    dir  = dplyr::case_when("
"0","      is.finite(skew) & skew >  1 ~ ""right"","
"0","      is.finite(skew) & skew < -1 ~ ""left"","
"0","      TRUE                        ~ ""none"""
"0","    )"
"0","  ) |>"
"0","  dplyr::ungroup() |>"
"0","  dplyr::filter(dir != ""none"") |>"
"0","  dplyr::arrange(dplyr::desc(abs(skew)))"
"0",""
"0","skew_tbl"
