"0","## ==== CHUNK M7K-2: LASSOパス学習（Train） & 親変数個数のカウント =============="
"0","y_tr <- with(trn, Surv(time2y, event2y))"
"0","fit_glmnet <- glmnet(x = X_tr, y = y_tr, family = ""cox"", alpha = 1, standardize = TRUE)"
"0",""
"0","lams   <- fit_glmnet$lambda"
"0","# 各λで非ゼロ列→親に集約→親のユニーク数を数える"
"0","parent_count <- vapply(seq_along(lams), function(j){"
"0","  b  <- as.matrix(fit_glmnet$beta)[, j, drop = TRUE]"
"0","  nz <- names(b)[which(abs(b) > 0)]"
"0","  if (!length(nz)) return(0L)"
"0","  length(unique(parent_by_col[nz]))"
"0","}, integer(1))"
"0",""
"0","lambda_grid <- data.frame("
"0","  idx = seq_along(lams),"
"0","  lambda = lams,"
"0","  n_parent = parent_count,"
"0","  stringsAsFactors = FALSE"
"0",")"
"0","print(head(lambda_grid, 10))"
