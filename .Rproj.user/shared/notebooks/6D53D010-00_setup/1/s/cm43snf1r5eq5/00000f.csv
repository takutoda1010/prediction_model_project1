"0","# ========================================================================"
"0","# 6. ユーティリティ関数"
"0","# ========================================================================"
"0",""
"0","#' セッション情報の記録"
"0","#' @param output_dir 出力ディレクトリ"
"0","save_session_info <- function(output_dir = NULL) {"
"0","  "
"0","  if (is.null(output_dir)) {"
"0","    paths <- setup_project_paths()"
"0","    output_dir <- paths$output"
"0","  }"
"0","  "
"0","  session_file <- file.path("
"0","    output_dir, "
"0","    sprintf(""session_info_%s.txt"", format(Sys.Date(), ""%Y%m%d""))"
"0","  )"
"0","  "
"0","  sink(session_file)"
"0","  cat(""=== Session Information ===\n"")"
"0","  cat(""Date:"", format(Sys.time(), ""%Y-%m-%d %H:%M:%S""), ""\n\n"")"
"0","  print(sessionInfo())"
"0","  sink()"
"0","  "
"0","  message(sprintf(""Session info saved to: %s"", session_file))"
"0","  invisible(NULL)"
"0","}"
"0",""
"0","#' メモリ使用状況の確認"
"0","check_memory_usage <- function() {"
"0","  # ガベージコレクション実行"
"0","  gc_result <- gc(verbose = FALSE)"
"0","  "
"0","  # 使用メモリ（MB）"
"0","  used_mb <- sum(gc_result[, ""used""]) / (1024^2) * gc_result[1, ""(Mb)""]"
"0","  max_mb <- sum(gc_result[, ""max used""]) / (1024^2) * gc_result[1, ""(Mb)""]"
"0","  "
"0","  message(sprintf(""Memory usage: %.1f MB (max: %.1f MB)"", used_mb, max_mb))"
"0","  "
"0","  return(invisible(list(used = used_mb, max = max_mb)))"
"0","}"
