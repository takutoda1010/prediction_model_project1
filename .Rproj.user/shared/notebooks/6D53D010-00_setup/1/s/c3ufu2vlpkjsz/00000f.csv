"0","################################################################################"
"0","# 00_setup.R - プロジェクト初期設定とパッケージ管理"
"0","# "
"0","# Description: "
"0","#   HCC再発予測モデルプロジェクトの環境設定"
"0","#   必要パッケージの自動インストールと読み込み"
"0","#   グローバル設定とユーティリティ関数の定義"
"0","#"
"0","# Author: Takuto Yoshida"
"0","# Date: 2024-11-07"
"0","################################################################################"
"0",""
"0","# ========================================================================"
"0","# 1. パッケージ管理"
"0","# ========================================================================"
"0",""
"0","#' 必要パッケージの自動インストールと読み込み"
"0","#' @param packages 文字ベクトル：パッケージ名のリスト"
"0","#' @param repos リポジトリURL（デフォルト: CRAN）"
"0","#' @return 無し（副作用：パッケージの読み込み）"
"0","ensure_packages <- function(packages, "
"0","                          repos = ""https://cloud.r-project.org/"") {"
"0","  "
"0","  # インストール済みパッケージの確認"
"0","  installed <- rownames(installed.packages())"
"0","  to_install <- setdiff(packages, installed)"
"0","  "
"0","  # 未インストールパッケージがあれば自動インストール"
"0","  if (length(to_install) > 0) {"
"0","    message(""========================================"")"
"0","    message(""Installing missing packages..."")"
"0","    message(""========================================"")"
"0","    "
"0","    for (pkg in to_install) {"
"0","      message(sprintf(""  Installing: %s"", pkg))"
"0","      install.packages(pkg, repos = repos, quiet = TRUE)"
"0","    }"
"0","    "
"0","    message(""Installation completed."")"
"0","  }"
"0","  "
"0","  # パッケージの読み込み"
"0","  loaded <- character()"
"0","  failed <- character()"
"0","  "
"0","  for (pkg in packages) {"
"0","    if (suppressPackageStartupMessages(require(pkg, character.only = TRUE))) {"
"0","      loaded <- c(loaded, pkg)"
"0","    } else {"
"0","      failed <- c(failed, pkg)"
"0","    }"
"0","  }"
"0","  "
"0","  # 結果の報告"
"0","  if (length(failed) > 0) {"
"0","    warning(""Failed to load packages: "", paste(failed, collapse = "", ""))"
"0","  }"
"0","  "
"0","  invisible(NULL)"
"0","}"
